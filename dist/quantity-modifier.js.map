{"version":3,"file":"quantity-modifier.js","sources":["../src/quantity-modifier.js"],"sourcesContent":["class QuantityModifier extends HTMLElement {\n  // Static flag to track if styles have been injected\n  static #stylesInjected = false;\n\n  constructor() {\n    super();\n    this.handleDecrement = this.handleDecrement.bind(this);\n    this.handleIncrement = this.handleIncrement.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n\n    // Inject styles once when first component is created\n    QuantityModifier.#injectStyles();\n  }\n\n  /**\n   * Inject global styles for hiding number input spin buttons\n   * Only runs once regardless of how many components exist\n   */\n  static #injectStyles() {\n    if (QuantityModifier.#stylesInjected) return;\n\n    // this will hide the arrow buttons in the number input field\n    const style = document.createElement('style');\n    style.textContent = `\n      /* Hide number input spin buttons for quantity-modifier */\n      quantity-modifier input::-webkit-outer-spin-button,\n      quantity-modifier input::-webkit-inner-spin-button {\n        -webkit-appearance: none;\n        margin: 0;\n      }\n      \n      quantity-modifier input[type=\"number\"] {\n        -moz-appearance: textfield;\n      }\n    `;\n\n    document.head.appendChild(style);\n    QuantityModifier.#stylesInjected = true;\n  }\n\n  // Define which attributes trigger attributeChangedCallback when modified\n  static get observedAttributes() {\n    return ['min', 'max', 'value'];\n  }\n\n  // Called when element is added to the DOM\n  connectedCallback() {\n    this.render();\n    this.attachEventListeners();\n  }\n\n  // Called when element is removed from the DOM\n  disconnectedCallback() {\n    this.removeEventListeners();\n  }\n\n  // Called when observed attributes change\n  attributeChangedCallback(name, oldValue, newValue) {\n    if (oldValue !== newValue) {\n      this.updateInput();\n    }\n  }\n\n  // Get minimum value allowed, defaults to 1\n  get min() {\n    return parseInt(this.getAttribute('min')) || 1;\n  }\n\n  // Get maximum value allowed, defaults to 99\n  get max() {\n    return parseInt(this.getAttribute('max')) || 99;\n  }\n\n  // Get current value, defaults to 1\n  get value() {\n    return parseInt(this.getAttribute('value')) || 1;\n  }\n\n  // Set current value by updating the attribute\n  set value(val) {\n    this.setAttribute('value', val);\n  }\n\n  // Render the quantity modifier HTML structure\n  render() {\n    const min = this.min;\n    const max = this.max;\n    const value = this.value;\n\n    // check to see if these fields already exist\n    const existingDecrement = this.querySelector('[data-action-decrement]');\n    const existingIncrement = this.querySelector('[data-action-increment]');\n    const existingInput = this.querySelector('[data-quantity-modifier-field]');\n\n    // if they already exist, just set the values\n    if (existingDecrement && existingIncrement && existingInput) {\n      existingInput.value = value;\n      existingInput.min = min;\n      existingInput.max = max;\n      existingInput.type = 'number';\n    } else {\n      // if they don't exist, inject the template\n      this.innerHTML = `\n        <button data-action-decrement type=\"button\">\n          <svg class=\"svg-decrement\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\">\n            <title>decrement</title>\n            <path fill=\"currentColor\" d=\"M368 224H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h352c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z\"></path>\n          </svg>\n        </button>\n        <input \n          type=\"number\" \n          inputmode=\"numeric\" \n          pattern=\"[0-9]*\" \n          data-quantity-modifier-field \n          value=\"${value}\" min=\"${min}\" max=\"${max}\">\n        <button data-action-increment type=\"button\">\n          <svg class=\"svg-increment\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 384 512\">\n            <title>increment</title>\n            <path fill=\"currentColor\" d=\"M368 224H224V80c0-8.84-7.16-16-16-16h-32c-8.84 0-16 7.16-16 16v144H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h144v144c0 8.84 7.16 16 16 16h32c8.84 0 16-7.16 16-16V288h144c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16z\"></path>\n          </svg>\n        </button>\n      `;\n    }\n  }\n\n  // Attach click and input event listeners to buttons and input field\n  attachEventListeners() {\n    const decrementBtn = this.querySelector('[data-action-decrement]');\n    const incrementBtn = this.querySelector('[data-action-increment]');\n    const input = this.querySelector('[data-quantity-modifier-field]');\n\n    if (decrementBtn) decrementBtn.addEventListener('click', this.handleDecrement);\n    if (incrementBtn) incrementBtn.addEventListener('click', this.handleIncrement);\n    if (input) input.addEventListener('change', this.handleInputChange);\n  }\n\n  // Remove event listeners to prevent memory leaks\n  removeEventListeners() {\n    const decrementBtn = this.querySelector('[data-action-decrement]');\n    const incrementBtn = this.querySelector('[data-action-increment]');\n    const input = this.querySelector('[data-quantity-modifier-field]');\n\n    if (decrementBtn) decrementBtn.removeEventListener('click', this.handleDecrement);\n    if (incrementBtn) incrementBtn.removeEventListener('click', this.handleIncrement);\n    if (input) input.removeEventListener('change', this.handleInputChange);\n  }\n\n  // Handle decrement button click, respects minimum value\n  handleDecrement() {\n    const currentValue = this.value;\n    const newValue = Math.max(currentValue - 1, this.min);\n    this.updateValue(newValue);\n  }\n\n  // Handle increment button click, respects maximum value\n  handleIncrement() {\n    const currentValue = this.value;\n    const newValue = Math.min(currentValue + 1, this.max);\n    this.updateValue(newValue);\n  }\n\n  // Handle direct input changes, clamps value between min and max\n  handleInputChange(event) {\n    const inputValue = parseInt(event.target.value);\n\n    if (!isNaN(inputValue)) {\n      const clampedValue = Math.max(this.min, Math.min(inputValue, this.max));\n      // Update the DOM input if the value was clamped\n      if (clampedValue !== inputValue) {\n        event.target.value = clampedValue;\n      }\n      this.updateValue(clampedValue);\n    }\n  }\n\n  // Update the component value and dispatch change event if value changed\n  updateValue(newValue) {\n    if (newValue !== this.value) {\n      this.value = newValue;\n      this.updateInput();\n      this.dispatchChangeEvent(newValue);\n    }\n  }\n\n  // Sync the input field with current component state\n  updateInput() {\n    const input = this.querySelector('[data-quantity-modifier-field]');\n    if (input) {\n      input.value = this.value;\n      input.min = this.min;\n      input.max = this.max;\n    }\n  }\n\n  // Dispatch custom event when value changes for external listeners\n  dispatchChangeEvent(value) {\n    this.dispatchEvent(\n      new CustomEvent('quantity-modifier:change', {\n        detail: { value },\n        bubbles: true,\n      })\n    );\n  }\n}\n\ncustomElements.define('quantity-modifier', QuantityModifier);\n\nexport { QuantityModifier };\nexport default QuantityModifier;\n"],"names":[],"mappings":"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"}